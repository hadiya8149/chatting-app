{"ast":null,"code":"import _regeneratorRuntime from\"/root/app/chat/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/root/app/chat/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"/root/app/chat/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/root/app/chat/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useRef}from\"react\";import logo from\"../girl.png\";import axios from\"axios\";import{io}from\"socket.io-client\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var socket=io({transports:['websocket']});export default function Chat(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),usersList=_useState2[0],setusersLists=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),message=_useState4[0],setMessage=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),messages=_useState6[0],setMessages=_useState6[1];var isFirstRender=useRef(true);useEffect(function(){var addMessage=function addMessage(msg){return setMessages(function(prevMessages){return[].concat(_toConsumableArray(prevMessages),[msg]);});};socket.on('chat message',addMessage);return function(){socket.off('chat message',addMessage);};});function handleSubmit(event){event.preventDefault();console.log(\"this is message in submit function\",message);socket.emit(\"chat message\",message);// msgRender.current = false;\n}function handleChange(event){event.preventDefault();setMessage(event.target.value);console.log(message);}function fetchUsers(){return _fetchUsers.apply(this,arguments);}function _fetchUsers(){_fetchUsers=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:try{axios.get(\"http://localhost:5000/api/peopleAPI\").then(function(response){return setusersLists(response.data);}).catch(function(error){console.log(error);}).then(function(data){return console.log(data);});}catch(error){console.log(error);}case 1:case\"end\":return _context.stop();}},_callee);}));return _fetchUsers.apply(this,arguments);}useEffect(function(){//subscribe once\nif(isFirstRender.current){fetchUsers();isFirstRender.current=false;}else{console.log(\"i am rendered multiple times\");}//unssubscribe on mount\n},[]);if(!usersList.length)return/*#__PURE__*/_jsx(\"h3\",{children:\"LOading...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"flex main-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"left-sidebar-chat sidebar-chat container \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo\",children:/*#__PURE__*/_jsx(\"img\",{id:\"logo\",alt:\"female icon\",src:logo})}),/*#__PURE__*/_jsx(\"span\",{children:\"My Dashboard\"}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:\"Messages\"}),/*#__PURE__*/_jsx(\"div\",{})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\" chat-section \",children:[/*#__PURE__*/_jsx(\"div\",{className:\"messages\",children:/*#__PURE__*/_jsx(\"ul\",{id:\"messages\",children:messages.map(function(msg,index){return/*#__PURE__*/_jsx(\"li\",{children:msg},index);})})}),/*#__PURE__*/_jsx(\"div\",{className:\"message-box\",children:/*#__PURE__*/_jsx(\"form\",{id:\"messaging-form\",onSubmit:handleSubmit,children:/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"input-group \",children:[/*#__PURE__*/_jsx(\"input\",{id:\"message-input\",className:\"col-sm-1 col-form\",type:\"text\",onChange:handleChange,value:message.value,name:\"message\",placeholder:\"Type message and hit enter\"}),/*#__PURE__*/_jsx(\"button\",{type:\"Submit\",id:\"send-message\",children:\"Send\"})]})})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"sidebar-chat  \",children:[/*#__PURE__*/_jsx(\"div\",{children:\"People\"}),/*#__PURE__*/_jsx(\"ul\",{children:usersList.map(function(user,index){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"user\",type:\"submit\",children:user})},index);})})]})]});}","map":{"version":3,"names":["React","useState","useEffect","useRef","logo","axios","io","jsx","_jsx","jsxs","_jsxs","socket","transports","Chat","_useState","_useState2","_slicedToArray","usersList","setusersLists","_useState3","_useState4","message","setMessage","_useState5","_useState6","messages","setMessages","isFirstRender","addMessage","msg","prevMessages","concat","_toConsumableArray","on","off","handleSubmit","event","preventDefault","console","log","emit","handleChange","target","value","fetchUsers","_fetchUsers","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","get","then","response","data","catch","error","stop","current","length","children","className","id","alt","src","map","index","onSubmit","type","onChange","name","placeholder","user"],"sources":["/root/app/chat/src/components/chat_page.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport logo from \"../girl.png\"\nimport axios from \"axios\"\nimport {io} from \"socket.io-client\"\n\nvar socket = io({\n    transports:['websocket']\n});\n\nexport default function Chat() {\n\n    const [usersList, setusersLists] = useState([])\n    const [message, setMessage]=useState(\"\")\n    const [messages, setMessages]=useState([])\n    const isFirstRender = useRef(true)\n    \n\n    useEffect(()=>{\n        const addMessage = (msg)=> setMessages(prevMessages=>[...prevMessages, msg])\n        socket.on('chat message', addMessage);\n         return ()=>{\n            socket.off('chat message', addMessage);\n        }\n        \n          \n        })\n\n    \n    function handleSubmit(event){\n        event.preventDefault();\n          \n        console.log(\"this is message in submit function\", message)\n        socket.emit(\"chat message\", message)\n        // msgRender.current = false;\n\n            \n        \n    }\n    function handleChange(event){\n        event.preventDefault();\n        setMessage(event.target.value);\n        console.log(message)\n    }\n    async function fetchUsers() {\n        try {\n            axios.get(\"http://localhost:5000/api/peopleAPI\")\n                .then((response) => setusersLists(response.data))\n                .catch((error) => {\n                    console.log(error);\n                })\n                .then((data) => console.log(data))\n        }\n        catch (error) {\n            console.log(error)\n        }\n\n\n    }\n    useEffect(() => {\n        //subscribe once\n\n        if (isFirstRender.current) {\n            fetchUsers();\n            isFirstRender.current = false;\n        }\n        else {\n            console.log(\"i am rendered multiple times\")\n        }\n\n//unssubscribe on mount\n    }\n        , []);\n    if (!usersList.length) return <h3>LOading...</h3>\n\n\n    return (\n        <div className=\"flex main-content\">\n            <div className=\"left-sidebar-chat sidebar-chat container \">\n\n                <div className=\"logo\">\n                    <img id=\"logo\" alt=\"female icon\" src={logo}></img>\n                </div>\n                <span>My Dashboard</span>\n\n                <hr />\n                <div>\n                    <div>\n                        Messages\n                    </div>\n                    <div>\n                    </div>\n                </div>\n            </div>\n            <div className=\" chat-section \">\n                <div className=\"messages\">\n                    <ul id=\"messages\">\n                    {messages.map((msg, index) => (\n                        <li key={index}>{msg}</li>\n                    ))}\n                    </ul>\n                </div>\n                <div className=\"message-box\">\n                    <form id=\"messaging-form\" onSubmit={handleSubmit}>\n                        <div className=\"d-flex justify-content-center\">\n                            <div className=\"input-group \">\n                                <input id=\"message-input\" className=\"col-sm-1 col-form\" type=\"text\" onChange={handleChange} value={message.value} name=\"message\" placeholder=\"Type message and hit enter\" />\n\n                                <button type=\"Submit\" id=\"send-message\">Send</button>\n                            </div>\n                        </div>\n\n\n                    </form>\n                </div>\n            </div>\n            <div className=\"sidebar-chat  \">\n                <div>People</div>\n                <ul>\n                    {usersList.map((user, index) => (\n                        <li key={index}><button className=\"user\" type=\"submit\">{user}</button></li>\n                    ))}\n                </ul>\n            </div>\n        </div>\n    );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}